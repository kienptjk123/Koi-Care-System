import{a0 as I,r as s,j as t,G as T,a1 as F,T as z,d as D,u as M,a as v,B as d}from"./index-B6lDE10X.js";import{L as A,H as U}from"./LeftSideBar-WMJExeXd.js";import{T as $}from"./TopLayoutAD-9qYOaepf.js";import{S as R}from"./sweetalert2.esm.all-D3pEHXw3.js";import{A as H,y as G,z as L}from"./index-C82jgAjb.js";import{p as P,a as q,C as O}from"./createSimplePaletteValueFilter-CtWn6jP0.js";import{u as Y,p as _,M as J,P as K}from"./Popover-D5wYuPsK.js";import{B as y,D as Q}from"./DataGrid-DSuF-7As.js";import{T as S}from"./TextField-RvuNpgap.js";import"./index-CwQ8PTPA.js";/* empty css            */import"./logo-DG-ZgLhE.js";import"./Transition-CB3Oswcw.js";import"./index-zdI1LHq1.js";import"./toPropertyKey-CGv2wOyp.js";import"./SwitchBase-D427YH2d.js";import"./useFormControl-BvYtAAlI.js";import"./Typography-D8_YzR8Q.js";import"./InputAdornment-B64BguAO.js";function V(i={}){const{themeId:u,defaultTheme:m,defaultClassName:h="MuiBox-root",generateClassName:n}=i,l=P("div",{shouldForwardProp:a=>a!=="theme"&&a!=="sx"&&a!=="as"})(I);return s.forwardRef(function(f,x){const r=Y(m),{className:j,component:p="div",...g}=_(f);return t.jsx(l,{as:p,ref:x,className:T(j,n?n(h):h),theme:u&&r[u]||r,...g})})}const W=q("MuiBox",["root"]),X=F(),b=V({themeId:z,defaultTheme:X,defaultClassName:W.root,generateClassName:O.generate});function we(){const{isDarkMode:i}=D(),[u,m]=s.useState([]),[h,n]=s.useState(!1),[l,C]=s.useState("");s.useState("defaultpassword");const[a,f]=s.useState(""),[x,r]=s.useState(!1),[j,p]=s.useState(!0),g=M(),w=async()=>{try{const e=localStorage.getItem("token");if(!e)throw new Error("No token found");const o=(await v.get("https://koicaresystemv2.azurewebsites.net/api/users",{headers:{Authorization:`Bearer ${e}`}})).data.data.filter(E=>E.role==="SHOP");m(o)}catch(e){console.log("Error fetching promotions:",e)}};s.useEffect(()=>{w()},[]);const k=async e=>{const{isConfirmed:c}=await R.fire({title:"Are you sure?",text:"You wonâ€™t be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, deactive it!"});if(c){p(!0);try{const o=localStorage.getItem("token");if(!o)throw new Error("No token found");await v.put(`https://koicaresystemv2.azurewebsites.net/api/users/delete/${e}`,{status:!1},{headers:{Authorization:`Bearer ${o}`}}),d.success("User deactivated successfully"),w()}catch(o){console.error(o),d.error("Failed to deactivate user")}}},N=[{field:"username",headerName:"Username",width:120},{field:"email",headerName:"Email",flex:1},{field:"role",headerName:"Role",width:120},{field:"status",headerName:"Status",width:100,renderCell:e=>t.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",width:"100%",padding:"0"},children:t.jsx(H,{color:e.row.status?"green":"red",className:`status-icon ${e.row.status?"active":"inactive"}`})})},{field:"actions",headerName:"Actions",width:150,renderCell:e=>t.jsxs("div",{style:{display:"flex",alignItems:"center",height:"100%"},children:[t.jsx("button",{className:"p-1 text-blue-500 hover:bg-blue-500 hover:text-white rounded-full mx-2",onClick:()=>{g(`/admin/updateShop/${e.row.id}`)},children:t.jsx(G,{className:"size-5"})}),t.jsx("button",{className:"p-1 text-red-500 hover:bg-red-500 hover:text-white rounded-full",onClick:()=>k(e.row.id),children:t.jsx(L,{className:"size-5"})})]})}],B=async()=>{n(!0);try{const e=localStorage.getItem("token");if(!e)throw new Error("No token found");if(!l)throw new Error("Username is required");const c={username:l,password:"defaultpassword"};a&&(c.email=a);const o=await v.post("https://koicaresystemv2.azurewebsites.net/api/users/register/staff",c,{headers:{Authorization:`Bearer ${e}`}});d.success("Staff created successfully!"),r(!1),w()}catch(e){console.log(e),e.response&&e.response.data&&e.response.data.message?d.error(`Failed to create staff: ${e.response.data.message}`):d.error("Failed to create staff.")}finally{n(!1)}};return t.jsx("div",{children:t.jsxs("div",{className:"h-screen flex",children:[t.jsx(A,{}),t.jsxs("div",{className:`relative ${i?"bg-custom-light text-white":"bg-white text-black"} overflow-y-auto flex-1 flex-col overflow-x-hidden duration-200 ease-linear`,children:[t.jsx(U,{}),t.jsxs("div",{className:"py-5 px-[30px] mx-auto max-w-[1750px]",children:[t.jsx($,{text:"Shop"}),t.jsx(b,{sx:{display:"flex",justifyContent:"space-between",marginBottom:"20px"},children:t.jsx(y,{variant:"contained",onClick:()=>r(!0),children:"Create Staff"})}),t.jsx(J,{open:x,onClose:()=>r(!1),children:t.jsx(b,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:t.jsxs("div",{style:{padding:"20px",backgroundColor:i?"#333":"#fff",width:"400px",borderRadius:"8px"},children:[t.jsx("h2",{children:"Create Staff"}),t.jsx(S,{label:"Username",value:l,onChange:e=>C(e.target.value),required:!0,style:{marginBottom:"20px",width:"100%"}}),t.jsx(S,{label:"Email (optional)",value:a,onChange:e=>f(e.target.value),style:{marginBottom:"20px",width:"100%"}}),t.jsx(y,{variant:"contained",onClick:B,style:{marginRight:"10px"},children:"Create"}),t.jsx(y,{variant:"outlined",onClick:()=>r(!1),children:"Cancel"})]})})}),t.jsx(K,{sx:{height:670},children:t.jsx(Q,{rows:u,columns:N,pageSize:10,rowHeight:80,getRowId:e=>e._id||e.id,checkboxSelection:!0,sx:{"& .MuiDataGrid-columnHeaders":{backgroundColor:i?"#333":"#f5f5f5"},"& .MuiDataGrid-row:hover":{backgroundColor:i?"rgb(36 48 63 / var(--tw-bg-opacity))":"#e0e0e0"}}})})]})]})]})})}export{we as default};
