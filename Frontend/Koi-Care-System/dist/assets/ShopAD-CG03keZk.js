import{aX as I,aY as F,r as s,aZ as T,a_ as z,j as t,M as D,F as M,a$ as $,b0 as A,b1 as U,d as R,u as H,aN as v,b2 as L,T as S,P,a as y,B as d}from"./index-D7N4awOg.js";import{L as G,H as q}from"./LeftSideBar-DOQdBzQD.js";import{T as O}from"./TopLayoutAD-CAQDU07V.js";import{S as Y}from"./sweetalert2.esm.all-D3pEHXw3.js";import{A as _,y as X,z as Z}from"./index-CQNJqrBT.js";import{D as J}from"./DataGrid-DuSzyrur.js";import"./index-CxgS5Qjg.js";/* empty css            */import"./logo-DG-ZgLhE.js";import"./index-D5F-hrya.js";import"./toPropertyKey-PLuKRk1e.js";import"./Typography-D4rTWEvF.js";import"./SwitchBase-B5oSQsTr.js";import"./InputAdornment-9KIW8hUR.js";function K(i={}){const{themeId:u,defaultTheme:h,defaultClassName:m="MuiBox-root",generateClassName:n}=i,l=I("div",{shouldForwardProp:a=>a!=="theme"&&a!=="sx"&&a!=="as"})(F);return s.forwardRef(function(f,x){const r=T(h),{className:j,component:p="div",...g}=z(f);return t.jsx(l,{as:p,ref:x,className:D(j,n?n(m):m),theme:u&&r[u]||r,...g})})}const Q=M("MuiBox",["root"]),V=$(),b=K({themeId:A,defaultTheme:V,defaultClassName:Q.root,generateClassName:U.generate});function me(){const{isDarkMode:i}=R(),[u,h]=s.useState([]),[m,n]=s.useState(!1),[l,C]=s.useState("");s.useState("defaultpassword");const[a,f]=s.useState(""),[x,r]=s.useState(!1),[j,p]=s.useState(!0),g=H(),w=async()=>{try{const e=localStorage.getItem("token");if(!e)throw new Error("No token found");const o=(await y.get("https://koicaresystemv2.azurewebsites.net/api/users",{headers:{Authorization:`Bearer ${e}`}})).data.data.filter(E=>E.role==="SHOP");h(o)}catch(e){console.log("Error fetching promotions:",e)}};s.useEffect(()=>{w()},[]);const N=async e=>{const{isConfirmed:c}=await Y.fire({title:"Are you sure?",text:"You wonâ€™t be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, deactive it!"});if(c){p(!0);try{const o=localStorage.getItem("token");if(!o)throw new Error("No token found");await y.put(`https://koicaresystemv2.azurewebsites.net/api/users/delete/${e}`,{status:!1},{headers:{Authorization:`Bearer ${o}`}}),d.success("User deactivated successfully"),w()}catch(o){console.error(o),d.error("Failed to deactivate user")}}},k=[{field:"username",headerName:"Username",width:120},{field:"email",headerName:"Email",flex:1},{field:"role",headerName:"Role",width:120},{field:"status",headerName:"Status",width:100,renderCell:e=>t.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",width:"100%",padding:"0"},children:t.jsx(_,{color:e.row.status?"green":"red",className:`status-icon ${e.row.status?"active":"inactive"}`})})},{field:"actions",headerName:"Actions",width:150,renderCell:e=>t.jsxs("div",{style:{display:"flex",alignItems:"center",height:"100%"},children:[t.jsx("button",{className:"p-1 text-blue-500 hover:bg-blue-500 hover:text-white rounded-full mx-2",onClick:()=>{g(`/admin/updateShop/${e.row.id}`)},children:t.jsx(X,{className:"size-5"})}),t.jsx("button",{className:"p-1 text-red-500 hover:bg-red-500 hover:text-white rounded-full",onClick:()=>N(e.row.id),children:t.jsx(Z,{className:"size-5"})})]})}],B=async()=>{n(!0);try{const e=localStorage.getItem("token");if(!e)throw new Error("No token found");if(!l)throw new Error("Username is required");const c={username:l,password:"defaultpassword"};a&&(c.email=a);const o=await y.post("https://koicaresystemv2.azurewebsites.net/api/users/register/staff",c,{headers:{Authorization:`Bearer ${e}`}});d.success("Staff created successfully!"),r(!1),w()}catch(e){console.log(e),e.response&&e.response.data&&e.response.data.message?d.error(`Failed to create staff: ${e.response.data.message}`):d.error("Failed to create staff.")}finally{n(!1)}};return t.jsx("div",{children:t.jsxs("div",{className:"h-screen flex",children:[t.jsx(G,{}),t.jsxs("div",{className:`relative ${i?"bg-custom-light text-white":"bg-white text-black"} overflow-y-auto flex-1 flex-col overflow-x-hidden duration-200 ease-linear`,children:[t.jsx(q,{}),t.jsxs("div",{className:"py-5 px-[30px] mx-auto max-w-[1750px]",children:[t.jsx(O,{text:"Shop"}),t.jsx(b,{sx:{display:"flex",justifyContent:"space-between",marginBottom:"20px"},children:t.jsx(v,{variant:"contained",onClick:()=>r(!0),children:"Create Staff"})}),t.jsx(L,{open:x,onClose:()=>r(!1),children:t.jsx(b,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:t.jsxs("div",{style:{padding:"20px",backgroundColor:i?"#333":"#fff",width:"400px",borderRadius:"8px"},children:[t.jsx("h2",{children:"Create Staff"}),t.jsx(S,{label:"Username",value:l,onChange:e=>C(e.target.value),required:!0,style:{marginBottom:"20px",width:"100%"}}),t.jsx(S,{label:"Email (optional)",value:a,onChange:e=>f(e.target.value),style:{marginBottom:"20px",width:"100%"}}),t.jsx(v,{variant:"contained",onClick:B,style:{marginRight:"10px"},children:"Create"}),t.jsx(v,{variant:"outlined",onClick:()=>r(!1),children:"Cancel"})]})})}),t.jsx(P,{sx:{height:670},children:t.jsx(J,{rows:u,columns:k,pageSize:10,rowHeight:80,getRowId:e=>e._id||e.id,checkboxSelection:!0,sx:{"& .MuiDataGrid-columnHeaders":{backgroundColor:i?"#333":"#f5f5f5"},"& .MuiDataGrid-row:hover":{backgroundColor:i?"rgb(36 48 63 / var(--tw-bg-opacity))":"#e0e0e0"}}})})]})]})]})})}export{me as default};
