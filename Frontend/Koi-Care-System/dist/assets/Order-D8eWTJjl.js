import{d as E,r as n,j as e,a as N,B as h}from"./index-B6lDE10X.js";import{L as R,H as I}from"./LeftSideBar-DCaJzvyX.js";import{T as B}from"./TopLayoutShop-u0HFtlA5.js";import{D as Z,v as T,u as H,t as P,w as $}from"./index-C82jgAjb.js";import{B as F,G as z}from"./index-BmowrEk6.js";import{b as G}from"./index-DHhrrXVP.js";import{u,w as L}from"./xlsx-DjuO7_Ju.js";import{S as V}from"./sweetalert2.esm.all-D3pEHXw3.js";import{P as _}from"./Popover-D5wYuPsK.js";import{D as U}from"./DataGrid-DSuF-7As.js";import"./index-CwQ8PTPA.js";import"./index-pU6niAKh.js";/* empty css            */import"./logo-DG-ZgLhE.js";import"./createSimplePaletteValueFilter-CtWn6jP0.js";import"./Transition-CB3Oswcw.js";import"./index-zdI1LHq1.js";import"./toPropertyKey-CGv2wOyp.js";import"./TextField-RvuNpgap.js";import"./useFormControl-BvYtAAlI.js";import"./SwitchBase-D427YH2d.js";import"./Typography-D8_YzR8Q.js";import"./InputAdornment-B64BguAO.js";function be(){const{isDarkMode:i}=E(),[x,y]=n.useState([]),[a,p]=n.useState(null),[v,g]=n.useState(!1),[Y,f]=n.useState(!0),[q,b]=n.useState(!1),m=t=>{const s=new Date(t),r=String(s.getDate()).padStart(2,"0"),l=String(s.getMonth()+1).padStart(2,"0"),d=s.getFullYear(),o=String(s.getHours()).padStart(2,"0"),j=String(s.getMinutes()).padStart(2,"0"),M=String(s.getSeconds()).padStart(2,"0");return`${o}:${j}:${M} ${r}/${l}/${d}`},S=t=>{p(t),g(!0)},c=t=>t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")+"đ",D=()=>{g(!1),p(null)},w=async()=>{try{const t=localStorage.getItem("token");if(!t)throw new Error("No token found");const r=(await N.get("https://koicaresystemv2.azurewebsites.net/api/orders/all",{headers:{Authorization:`Bearer ${t}`}})).data.data.sort((l,d)=>d.id-l.id);y(r)}catch(t){console.log("Error fetching Orders:",t)}};n.useEffect(()=>{w()},[]);const C=async t=>{var l,d;if(x.find(o=>o.id===t).status!=="PROCESSING"){h.warning("You can only update delivery for orders with the status PROCESSING.");return}const{isConfirmed:r}=await V.fire({title:"Are you sure?",text:"You won’t be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, update delivery!"});if(r){f(!0),b(!0);try{const o=localStorage.getItem("token"),j=await N.put(`https://koicaresystemv2.azurewebsites.net/api/orders/${t}/order/delivery`,{},{headers:{Authorization:`Bearer ${o}`}});h.success("Updated Delivery Status Successfully!"),w()}catch(o){console.log(o),h.error(((d=(l=o.response)==null?void 0:l.data)==null?void 0:d.message)||"Failed to update status.")}finally{b(!1),f(!1)}}},k=t=>{C(t)},A=[{field:"id",headerName:"Order ID",width:100},{field:"orderDate",headerName:"Order Date",width:170,renderCell:t=>m(t.row.orderDate)},{field:"recipientName",headerName:"Recipient Name",width:150},{field:"phone",headerName:"Phone",width:120},{field:"address",headerName:"Address",flex:1},{field:"totalAmount",headerName:"Total Amount",width:150,renderCell:t=>c(t.row.totalAmount)},{field:"status",headerName:"Order Status",width:150,renderCell:t=>{const s=t.value;let r="border-2 text-sm font-medium py-1 px-2 rounded text-center";switch(s){case"PENDING":r+=" border-yellow-500 text-yellow-500";break;case"PROCESSING":r+=" border-blue-500 text-blue-500";break;case"DELIVERED":r+=" border-green-500 text-green-500";break;case"CANCELLED":r+=" border-red-500 text-red-500";break;default:r+=" border-gray-500 text-gray-500"}return e.jsx("div",{className:"h-full flex justify-center items-center",children:e.jsx("div",{className:r,children:s})})}},{field:"action",headerName:"Action",renderCell:t=>e.jsxs("div",{className:"flex h-full justify-center items-center",children:[e.jsx("button",{className:"p-1 hover:bg-green-500 text-green-500 hover:text-white  rounded-full",onClick:()=>S(t.row),children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"size-6",children:[e.jsx("path",{fillRule:"evenodd",d:"M7.502 6h7.128A3.375 3.375 0 0 1 18 9.375v9.375a3 3 0 0 0 3-3V6.108c0-1.505-1.125-2.811-2.664-2.94a48.972 48.972 0 0 0-.673-.05A3 3 0 0 0 15 1.5h-1.5a3 3 0 0 0-2.663 1.618c-.225.015-.45.032-.673.05C8.662 3.295 7.554 4.542 7.502 6ZM13.5 3A1.5 1.5 0 0 0 12 4.5h4.5A1.5 1.5 0 0 0 15 3h-1.5Z",clipRule:"evenodd"}),e.jsx("path",{fillRule:"evenodd",d:"M3 9.375C3 8.339 3.84 7.5 4.875 7.5h9.75c1.036 0 1.875.84 1.875 1.875v11.25c0 1.035-.84 1.875-1.875 1.875h-9.75A1.875 1.875 0 0 1 3 20.625V9.375ZM6 12a.75.75 0 0 1 .75-.75h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H6.75a.75.75 0 0 1-.75-.75V12Zm2.25 0a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75ZM6 15a.75.75 0 0 1 .75-.75h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H6.75a.75.75 0 0 1-.75-.75V15Zm2.25 0a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75ZM6 18a.75.75 0 0 1 .75-.75h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H6.75a.75.75 0 0 1-.75-.75V18Zm2.25 0a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75Z",clipRule:"evenodd"})]})}),e.jsx("button",{className:"p-1 hover:bg-blue-500 text-blue-500 hover:text-white  rounded-full",onClick:()=>k(t.row.id),children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"size-6",children:[e.jsx("path",{d:"M3.375 4.5C2.339 4.5 1.5 5.34 1.5 6.375V13.5h12V6.375c0-1.036-.84-1.875-1.875-1.875h-8.25ZM13.5 15h-12v2.625c0 1.035.84 1.875 1.875 1.875h.375a3 3 0 1 1 6 0h3a.75.75 0 0 0 .75-.75V15Z"}),e.jsx("path",{d:"M8.25 19.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0ZM15.75 6.75a.75.75 0 0 0-.75.75v11.25c0 .087.015.17.042.248a3 3 0 0 1 5.958.464c.853-.175 1.522-.935 1.464-1.883a18.659 18.659 0 0 0-3.732-10.104 1.837 1.837 0 0 0-1.47-.725H15.75Z"}),e.jsx("path",{d:"M19.5 19.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0Z"})]})})]})}],O=()=>{const t=u.json_to_sheet(x.map(r=>({"Order ID":r.id,"Recipient Name":r.recipientName,"Order Date":m(r.orderDate),"Total Amount":c(r.totalAmount),Address:r.address,Note:r.note,Status:r.status}))),s=u.book_new();u.book_append_sheet(s,t,"Orders"),L(s,"orders.xlsx")};return e.jsxs("div",{className:"h-screen flex",children:[e.jsx(R,{}),e.jsxs("div",{className:`relative ${i?"bg-custom-light text-white":"bg-white text-black"} overflow-y-auto flex-1 flex-col overflow-x-hidden duration-200 ease-linear`,children:[e.jsx(I,{}),e.jsxs("div",{className:"py-5 px-[30px] mx-auto max-w-[1750px]",children:[e.jsx(B,{text:"Orders",links:"shop/order"}),e.jsx("div",{className:"w-full flex justify-end items-center relative",children:e.jsx("button",{onClick:O,className:"mb-4 p-2 bg-blue-500 text-white hover:bg-blue-700 rounded-md",children:"Download Excel"})}),e.jsx(_,{sx:{height:670},children:e.jsx(U,{rows:x,columns:A,pageSize:10,pageSizeOptions:[5,10,20,50,100],rowHeight:60,checkboxSelection:!0,disableExtendRowFullWidth:!0,getRowId:t=>t.id,sx:{"& .MuiDataGrid-columnHeaders":{backgroundColor:i?"#333":"#f5f5f5"},"& .MuiDataGrid-row:hover":{backgroundColor:i?"rgb(36 48 63 / var(--tw-bg-opacity))":"#e0e0e0"}}})}),v&&a&&e.jsx("div",{className:`fixed top-0 left-0 overflow-auto w-full h-full flex justify-center items-center z-50 bg-opacity-50 ${i?"bg-gray-900 text-gray-200":"bg-gray-800 text-gray-600"}`,children:e.jsxs("div",{className:`p-4 border rounded-lg max-h-[80vh] max-w-[100vw] overflow-auto ${i?"bg-gray-800 border-gray-700":"bg-white"}`,children:[e.jsx("h3",{className:"text-xl text-center font-bold mb-4",children:"ORDER DETAILS"}),e.jsxs("div",{className:" p-4 border rounded-lg shadow-lg",children:[e.jsxs("p",{className:"mb-3 flex items-center gap-2",children:[e.jsx(Z,{className:"text-2xl text-blue-500"}),e.jsx("strong",{children:"Order ID:"})," ",a.id]}),e.jsxs("p",{className:"mb-3 flex items-center gap-2",children:[e.jsx(F,{className:"text-2xl text-purple-500"}),e.jsx("strong",{children:"Order Date:"})," ",m(a.orderDate)]}),e.jsxs("p",{className:"mb-3 flex items-center gap-2",children:[e.jsx(T,{className:"text-2xl text-red-500"}),e.jsx("strong",{children:"Address:"})," ",a.address]}),e.jsxs("p",{className:"mb-3 flex items-center gap-2",children:[e.jsx(H,{className:"text-2xl text-green-500"}),e.jsx("strong",{children:"Phone:"})," ",a.phone]}),e.jsxs("p",{className:"mb-3 flex items-center gap-2",children:[e.jsx(z,{className:"text-2xl text-yellow-500"}),e.jsx("strong",{children:"Note:"})," ",a.note]}),e.jsxs("p",{className:"mb-3 flex items-center gap-2",children:[e.jsx(P,{className:"text-2xl text-blue-500"}),e.jsx("strong",{children:"RecipientName:"})," ",a.recipientName]}),e.jsxs("p",{className:"mb-3 flex items-center gap-2",children:[e.jsx(G,{className:"text-2xl text-red-500"}),e.jsx("strong",{children:"Status:"})," ",a.status]}),e.jsxs("p",{className:"mb-3 flex items-center gap-2",children:[e.jsx($,{className:"text-2xl text-green-500"})," ",e.jsx("strong",{children:"Total Amount:"})," ",c(a.totalAmount)]})]}),e.jsxs("div",{className:"Order-Table overflow-auto p-4 mt-4 shadow-lg border rounded-lg",children:[e.jsx("h2",{className:"text-xl font-bold mb-2",children:"Item Details"}),e.jsxs("table",{className:"min-w-full border-spacing-x-1 border-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"py-3 px-4 text-center text-xs font-bold uppercase",children:"No"}),e.jsx("th",{className:"py-3 px-2 text-center text-xs font-bold uppercase",children:"Product Name"}),e.jsx("th",{className:"py-3 px-2 text-center text-xs font-bold uppercase",children:"Quantity"}),e.jsx("th",{className:"py-3 px-2 text-center text-xs font-bold uppercase",children:"Total Price"})]})}),e.jsx("tbody",{children:a.items.map((t,s)=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-1 text-center border-b border-gray-200",children:s+1}),e.jsx("td",{className:"py-2 px-1 text-center border-b border-gray-200",children:t.productName}),e.jsx("td",{className:"py-2 px-1 text-center border-b border-gray-200",children:t.quantity}),e.jsx("td",{className:"py-2 px-1 text-center border-b border-gray-200",children:c(t.price*t.quantity)})]},t.id))})]})]}),e.jsx("button",{className:"mt-4 px-4 py-2 bg-red-500 text-white rounded",onClick:D,children:"Close"})]})})]})]})]})}export{be as default};
