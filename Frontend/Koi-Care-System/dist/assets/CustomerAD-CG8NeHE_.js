import{r as l,d as N,j as e,P as A,a as h,L as j,B as s}from"./index-D0YIHR4A.js";import{L as D,H as M}from"./LeftSideBar-DOwFXw7W.js";import{T as y}from"./TopLayoutAD-DnNjyfqe.js";import{j as P,B as S}from"./index-BMdVHJVA.js";import{D as E}from"./DataGrid-IWRB1K2w.js";import"./index-DfkVdce-.js";/* empty css            */import"./logo-DG-ZgLhE.js";import"./index-iH4zfJEX.js";import"./toPropertyKey-PLuKRk1e.js";import"./Typography-CvIXc89m.js";import"./SwitchBase-ATyY8G7j.js";import"./InputAdornment-wNGMamr6.js";function F(){const[n,u]=l.useState([]),{isDarkMode:i}=N(),[p,c]=l.useState([]),f="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAkFBMVEX///8WFhgAAAD...",m=async()=>{try{const r=localStorage.getItem("token");if(!r)throw new Error("No token found");const o=(await h.get("https://koicaresystemv2.azurewebsites.net/api/subscribe/all",{headers:{Authorization:`Bearer ${r}`}})).data.data.map(t=>({id:t.userProfileDto.id,name:t.userProfileDto.name,email:t.userProfileDto.email,phone:t.userProfileDto.phone,address:t.userProfileDto.address,createdDate:t.userProfileDto.createdDate,dateOfBirth:t.userProfileDto.dateOfBirth,role:t.userProfileDto.role,avatar:t.userProfileDto.avatar,status:t.subscribe,startDate:t.startDate,expiredDate:t.expiredDate}));c(o)}catch(r){console.log("Error fetching users:",r)}},x=async(r,a,o)=>{if(o==="SHOP"){s.error("Shop users cannot be upgraded to PREMIUM");return}try{const t=localStorage.getItem("token");if(!t)throw new Error("No token found");const v={userProfileId:r,time:a};(await h.put("https://koicaresystemv2.azurewebsites.net/api/subscribe/upgrade",v,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}})).status===200?(s.success("Subscription upgraded successfully"),c(b=>b.map(d=>d.id===r?{...d,status:"PREMIUM"}:d))):s.error("Failed to upgrade subscription")}catch(t){console.error("Error upgrading subscription:",t),t.response?s.error(`Error: ${t.response.data.message||"Subscription upgrade failed"}`):t.request?s.error("No response from server. Please try again later."):s.error("Error: "+t.message)}},g=(r,a)=>{u(o=>({...o,[r]:a}))};l.useEffect(()=>{m()},[]);const w=[{field:"image",headerName:"Image",width:100,renderCell:r=>e.jsx("img",{src:r.row.avatar||f,alt:"User",className:"w-24 h-16 object-cover rounded-md"})},{field:"name",headerName:"Name",width:120},{field:"email",headerName:"Email",width:250},{field:"phone",headerName:"Phone",width:110},{field:"address",headerName:"Address",flex:1},{field:"createdDate",headerName:"Create Date",width:120},{field:"dateOfBirth",headerName:"Date of Birth",width:120},{field:"role",headerName:"Role",width:80},{field:"status",headerName:"Status",width:100,renderCell:r=>e.jsx("div",{className:"h-full flex justify-center items-center",children:e.jsx("div",{className:`flex items-center justify-center py-1 px-2 rounded text-sm font-medium
            ${r.value==="PREMIUM"?"bg-yellow-200 text-yellow-700":"bg-gray-200 text-gray-700"}`,children:r.value==="PREMIUM"?e.jsxs("div",{className:"flex gap-1",children:[e.jsx(P,{className:"w-4 h-4"}),r.value==="PREMIUM"?"PREMIUM":"NORMAL"]}):e.jsx("div",{children:"NORMAL"})})})},{field:"startDate",headerName:"Start Date",width:120},{field:"expiredDate",headerName:"Expired Date",width:120},{field:"duration",headerName:"Duration",width:180,renderCell:r=>e.jsxs("select",{value:n[r.row.id]||"",onChange:a=>g(r.row.id,a.target.value),className:"bg-white border border-gray-300  text-black rounded px-2 py-1",children:[e.jsx("option",{value:"",children:"Select Duration"}),e.jsx("option",{value:"1MONTH",children:"1 Month"}),e.jsx("option",{value:"6MONTHS",children:"6 Months"}),e.jsx("option",{value:"12MONTHS",children:"12 Months"})]})},{field:"action",headerName:"Action",renderCell:r=>e.jsxs("div",{className:"flex h-full justify-center items-center gap-2",children:[e.jsx(j,{to:`/admin/user/${r.row.userId}`,className:"p-1 hover:bg-green-500 text-green-500 hover:text-white rounded-full",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"size-6",children:[e.jsx("path",{d:"M7.502 6h7.128A3.375 3.375 0 0 1 18 9.375v9.375a3 3 0 0 0 3-3V6.108c0-1.505-1.125-2.811-2.664-2.94a48.972 48.972 0 0 0-.673-.05A3 3 0 0 0 15 1.5h-1.5a3 3 0 0 0-2.663 1.618c-.225.015-.45.032-.673.05C8.662 3.295 7.554 4.542 7.502 6ZM13.5 3A1.5 1.5 0 0 0 12 4.5h4.5A1.5 1.5 0 0 0 15 3h-1.5Z"}),e.jsx("path",{d:"M3 9.375C3 8.339 3.84 7.5 4.875 7.5h9.75c1.036 0 1.875.84 1.875 1.875v11.25c0 1.035-.84 1.875-1.875 1.875h-9.75A1.875 1.875 0 0 1 3 20.625V9.375ZM6 12a.75.75 0 0 1 .75-.75h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H6.75a.75.75 0 0 1-.75-.75V12Zm2.25 0a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75ZM6 15a.75.75 0 0 1 .75-.75h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H6.75a.75.75 0 0 1-.75-.75V15Zm2.25 0a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H9a.75.75 0 0 1-.75-.75Z"})]})}),e.jsx("button",{onClick:()=>x(r.row.id,n[r.row.id],r.row.role),className:"p-1 text-blue-500 hover:text-blue-700",title:"Upgrade Subscription",children:e.jsx(S,{className:"w-5 h-5"})})]})}];return e.jsxs("div",{className:"h-screen flex",children:[e.jsx(D,{}),e.jsxs("div",{className:`relative ${i?"bg-custom-light text-white":"bg-white text-black"} overflow-y-auto flex-1 flex-col overflow-x-hidden duration-200 ease-linear`,children:[e.jsx(M,{}),e.jsxs("div",{className:"py-5 px-[30px] mx-auto max-w-[1750px]",children:[e.jsx(y,{text:"Users"}),e.jsx(A,{sx:{height:670},children:e.jsx(E,{rows:p,columns:w,pageSize:10,rowHeight:80,getRowId:r=>r.id,checkboxSelection:!0,sx:{"& .MuiDataGrid-columnHeaders":{backgroundColor:i?"#333":"#f5f5f5"},"& .MuiDataGrid-row:hover":{backgroundColor:i?"rgb(36 48 63 / var(--tw-bg-opacity))":"#e0e0e0"}}})})]})]})]})}export{F as default};
