import{r as l,d as Re,j as e,a as d}from"./index-B6lDE10X.js";import{L as Le,H as Ue}from"./LeftSideBar-WMJExeXd.js";import{T as Ke}from"./TopLayoutAD-9qYOaepf.js";import{E as Ge,D as He,H as We,I as Ve}from"./index-C82jgAjb.js";import{d as Xe}from"./index-DHhrrXVP.js";import{b as qe}from"./index-CwQ8PTPA.js";import{P as Y,a as T,d as m}from"./dayjs.min-rL_wHeDS.js";import{R as x,q as N,T as p,B as O,a as v,C as z,X as I,Y as $,L as D}from"./BarChart-DxSscTyZ.js";import{L as B,a as R}from"./LineChart-BtrU6w_Q.js";import{P as L}from"./Popover-D5wYuPsK.js";import{A as Je,a as U}from"./AreaChart-B_dAGL9y.js";import{D as K}from"./DataGrid-DSuF-7As.js";/* empty css            */import"./logo-DG-ZgLhE.js";import"./isEqual-B5Z5d6Tx.js";import"./index-zdI1LHq1.js";import"./createSimplePaletteValueFilter-CtWn6jP0.js";import"./Transition-CB3Oswcw.js";import"./toPropertyKey-CGv2wOyp.js";import"./TextField-RvuNpgap.js";import"./useFormControl-BvYtAAlI.js";import"./SwitchBase-D427YH2d.js";import"./Typography-D8_YzR8Q.js";import"./InputAdornment-B64BguAO.js";function Nt(){const[k,G]=l.useState(0),[S,H]=l.useState(0),[W,V]=l.useState([]);l.useState([]);const[P,X]=l.useState(0),[q,C]=l.useState([]),[J,Q]=l.useState({labels:[],data:[]}),[Z,_]=l.useState(0),[f,ee]=l.useState(0),[y,te]=l.useState(0),[se,re]=l.useState([]),[ae,oe]=l.useState(0),[ne,le]=l.useState(0),{isDarkMode:u}=Re(),[E,ie]=l.useState([]),[A,ce]=l.useState([]),[de,me]=l.useState([]),[he,xe]=l.useState([]),[ue,ge]=l.useState([]),[F,pe]=l.useState([]),[j,fe]=l.useState([]),[ye,je]=l.useState([]),g=t=>t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")+"Ä‘",[b,be]=l.useState("day"),we=async()=>{try{const t=localStorage.getItem("token");if(!t)throw new Error("No token found");const s=await d.get("https://koicaresystemv2.azurewebsites.net/api/profile/all/member",{headers:{Authorization:`Bearer ${t}`}}),o={};s.data.data.forEach(r=>{const n=r.createdDate;o[n]||(o[n]={date:n,users:0,usersPremium:0}),o[n].users+=1,r.status==="PREMIUM"&&(o[n].usersPremium+=1)});const a=Object.values(o);xe(a),me(s.data.data)}catch(t){return t}},Ne=async()=>{try{const t=localStorage.getItem("token");if(!t)throw new Error("No token found. Please log in to continue.");const o=(await d.get("https://koicaresystemv2.azurewebsites.net/api/profile/all/member",{headers:{Authorization:`Bearer ${t}`}})).data.data||[];if(o.length===0)throw new Error("No members found.");const a=o.filter(i=>i.status==="PREMIUM");G(a.length);const r=o.length,n=a.length;H(r),V([{value:n},{value:r-n}])}catch(t){console.error("Error fetching members:",t.message||t)}},ve=async()=>{try{const t=localStorage.getItem("token");if(!t)throw new Error("No token found");const o=(await d.get("https://koicaresystemv2.azurewebsites.net/api/orders/all",{headers:{Authorization:`Bearer ${t}`}})).data.data;fe(o);const a=m(),r=[];for(let n=0;n<7;n++){const i=a.subtract(n,"day").format("YYYY-MM-DD"),h=o.filter(w=>m(w.orderDate).format("YYYY-MM-DD")===i).reduce((w,Be)=>w+Be.totalAmount,0);r.unshift({name:`Day ${7-n}`,value:h})}re(r)}catch(t){console.log("Error fetching Orders:",t)}},De=async()=>{try{const t=localStorage.getItem("token");if(!t)throw new Error("No token found");const s=await d.get("https://koicaresystemv2.azurewebsites.net/api/orders/all",{headers:{Authorization:`Bearer ${t}`}}),o=m().format("YYYY-MM-DD"),a=s.data.data.filter(i=>m(i.orderDate).format("YYYY-MM-DD")===o),r=a.length,n=a.reduce((i,c)=>i+c.totalAmount,0);oe(r),le(n)}catch(t){console.log("Error fetching Orders:",t)}},ke=async()=>{try{const t=localStorage.getItem("token");if(!t)throw new Error("No token found");const s=await d.get("https://koicaresystemv2.azurewebsites.net/api/reports/category",{headers:{Authorization:`Bearer ${t}`}});ie(s.data.data)}catch(t){console.log("Error fetching category:",t)}},Se=async()=>{try{const t=localStorage.getItem("token");if(!t)throw new Error("No token found");const o=(await d.get("https://koicaresystemv2.azurewebsites.net/api/subscribe/all",{headers:{Authorization:`Bearer ${t}`}})).data.data,a=new Date().toISOString().split("T")[0],r=o.filter(n=>new Date(n.startDate).toISOString().split("T")[0]===a&&n.subscribe==="PREMIUM");C(r),X(r.length)}catch(t){console.log("Error fetching subscribers:",t)}},Pe=async()=>{try{const t=localStorage.getItem("token");if(!t)throw new Error("No token found");const o=(await d.get("https://koicaresystemv2.azurewebsites.net/api/subscribe/all",{headers:{Authorization:`Bearer ${t}`}})).data.data,a=new Date,r={};for(let i=0;i<7;i++){const c=new Date(a);c.setDate(a.getDate()-i),r[c.toISOString().split("T")[0]]=0}o.forEach(i=>{const c=new Date(i.startDate).toISOString().split("T")[0];i.subscribe==="PREMIUM"&&r[c]!==void 0&&(r[c]+=1)});const n=Object.keys(r).map(i=>({date:i,count:r[i]})).reverse();C(n)}catch(t){console.log("Error fetching subscribers:",t)}},Ce=async()=>{try{const t=localStorage.getItem("token");if(!t)throw new Error("No token found");const s=await d.get("https://koicaresystemv2.azurewebsites.net/api/reports/product",{headers:{Authorization:`Bearer ${t}`}});ce(s.data.data)}catch(t){console.log("Error fetching products:",t)}},Ee=async()=>{try{const t=localStorage.getItem("token");if(!t)throw new Error("No token found");const s=await d.get("https://koicaresystemv2.azurewebsites.net/api/blog",{headers:{Authorization:`Bearer ${t}`}});ge(s.data.data)}catch(t){console.log("Error fetching blogs:",t)}},Ae=async()=>{try{const t=localStorage.getItem("token");if(!t)throw new Error("No token found");const a=(await d.get("https://koicaresystemv2.azurewebsites.net/api/payment/all",{headers:{Authorization:`Bearer ${t}`}})).data.data.filter(c=>c.status==="COMPLETED");pe(a);const r=a.reduce((c,h)=>c+h.amount,0);if(_(r),f!==0){const c=(r-f)/f*100;te(c)}ee(r);const n={};a.forEach(c=>{const h=m(c.createDate).format("YYYY-MM");n[h]||(n[h]=0),n[h]+=c.amount});const i=Object.keys(n).map(c=>({name:c,uv:n[c]}));Q(i)}catch(t){console.log("Error fetching Payments:",t)}},Fe=t=>t>0?`+${t.toFixed(2)}%`:`${t.toFixed(2)}%`,Me=async()=>{try{const t=localStorage.getItem("token");if(!t)throw new Error("No token found");const s=await d.get("https://koicaresystemv2.azurewebsites.net/api/suppliers/all",{headers:{Authorization:`Bearer ${t}`}});je(s.data.data)}catch(t){console.log("Error fetching tags:",t)}};l.useEffect(()=>{we(),ve(),ke(),Ce(),Ae(),Ee(),Me(),De(),Se(),Pe(),Ne()},[]);const Ye=[{field:"image",headerName:"Image",width:100,renderCell:t=>e.jsx("div",{className:"h-full flex items-center",children:e.jsx("img",{src:t.row.imageUrl,alt:"Product",className:"w-20 h-16 object-cover rounded-md "})})},{field:"productName",headerName:"Product Name",flex:1},{field:"percent",headerName:"Percent",width:100,renderCell:t=>e.jsxs("div",{className:"relative w-full mt-6",children:[e.jsx("div",{className:"absolute inset-0 bg-green-300",style:{width:`${t.row.percent}%`}}),e.jsxs("div",{className:"relative z-10 text-sm border font-semibold text-green-500 text-center",children:[t.row.percent,"%"]})]})},{field:"totalPrice",headerName:"Total Price",width:100,renderCell:t=>g(t.row.totalPrice)}],Te=t=>{const s=new Date(t),o=String(s.getDate()).padStart(2,"0"),a=String(s.getMonth()+1).padStart(2,"0"),r=s.getFullYear(),n=String(s.getHours()).padStart(2,"0"),i=String(s.getMinutes()).padStart(2,"0"),c=String(s.getSeconds()).padStart(2,"0");return`${n}:${i}:${c} ${o}/${a}/${r}`},Oe=[{field:"id",headerName:"ID",width:50},{field:"orderDate",headerName:"Date",flex:1,renderCell:t=>Te(t.row.orderDate)},{field:"recipientName",headerName:"Name",width:100},{field:"status",headerName:"Status",width:130,renderCell:t=>{const s=t.value;let o="border-2 text-sm font-medium py-1 px-2 rounded text-center";switch(s){case"PENDING":o+=" border-yellow-500 text-yellow-500";break;case"PROCESSING":o+=" border-blue-500 text-blue-500";break;case"DELIVERED":o+=" border-green-500 text-green-500";break;case"CANCELLED":o+=" border-red-500 text-red-500";break;default:o+=" border-gray-500 text-gray-500"}return e.jsx("div",{className:"h-full flex justify-center items-center",children:e.jsx("div",{className:o,children:s})})}},{field:"totalPrice",headerName:"Total Price",width:100,renderCell:t=>g(t.row.totalAmount)}],ze=[...j].sort((t,s)=>new Date(s.orderDate)-new Date(t.orderDate)),Ie=(()=>{const t=[],s={},o=a=>b==="day"?m(a).format("YYYY-MM-DD"):b==="month"?m(a).format("YYYY-MM"):m(a).format("YYYY");F.forEach(a=>{const r=o(a.createDate);s[r]||(s[r]={date:r,paymentAmount:0,orderAmount:0}),s[r].paymentAmount+=a.amount}),j.forEach(a=>{const r=o(a.orderDate);s[r]||(s[r]={date:r,paymentAmount:0,orderAmount:0}),s[r].orderAmount+=a.totalAmount});for(const a in s)t.push(s[a]);return t.sort((a,r)=>m(a.date).isBefore(m(r.date))?-1:1)})(),M=["#0088FE","#00C49F","#FFBB28","#FF8042","#FF5733"],$e=({percent:t})=>` ${t.toFixed(2)}%`;return e.jsxs("div",{className:"h-screen flex",children:[e.jsx(Le,{}),e.jsxs("div",{className:`relative ${u?"bg-custom-light text-white":"bg-white text-black"} overflow-y-auto flex-1 flex-col overflow-x-hidden duration-200 ease-linear`,children:[e.jsx(Ue,{}),e.jsxs("div",{className:"py-5 px-[30px] max-w-[1750px] mx-auto",children:[e.jsx(Ke,{text:"Dashboard"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 xl:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-indigo-500 text-white rounded-lg shadow-lg p-4 min-h-[200px] sm:min-h-[250px] md:min-h-[300px]",children:[e.jsx("h2",{className:"text-3xl font-semibold",children:g(ne)}),e.jsx("p",{className:"text-lg mb-2",children:ae}),e.jsx("p",{className:"text-m flex items-center",children:e.jsx("span",{className:"mr-1",children:"Order Today"})}),e.jsx("div",{className:"h-16 mt-4 rounded-lg",children:e.jsx(x,{width:"100%",height:"100%",children:e.jsx(B,{data:se,children:e.jsx(R,{type:"monotone",dataKey:"value",stroke:"#F8F8FF",strokeWidth:2,dot:!0})})})})]}),e.jsxs("div",{className:"bg-blue-500 text-white rounded-lg shadow-lg p-4 min-h-[250px] sm:min-h-[250px] md:min-h-[300px]",children:[e.jsxs("h2",{className:"text-3xl font-semibold",children:[k," "]}),e.jsxs("p",{className:"text-sm flex items-center",children:[e.jsxs("span",{className:"text-lg mr-1",children:[S>0?(k/S*100).toFixed(1):0,"%"]}),e.jsx("span",{className:"text-green-300",children:"â†‘"})]}),e.jsx("p",{className:"text-lg ",children:"Premium user"}),e.jsx("div",{className:"h-16 mt-4 rounded-lg",children:e.jsx(x,{width:"100%",height:165,children:e.jsxs(Y,{children:[e.jsxs(T,{data:W,cx:"50%",cy:"50%",startAngle:180,endAngle:0,innerRadius:60,outerRadius:80,dataKey:"value",children:[e.jsx(N,{fill:"#00FA9A"},"cell-0"),e.jsx(N,{fill:"#FFFFE0"},"cell-1")]}),e.jsx(p,{})]})})})]}),e.jsxs("div",{className:"bg-yellow-500 text-white rounded-lg shadow-lg p-4 min-h-[200px] sm:min-h-[250px] md:min-h-[300px]",children:[e.jsx("h2",{className:"text-3xl font-semibold",children:P}),e.jsxs("p",{className:"text-lg mb-2",children:[P," Subscribers Today"]}),e.jsx("p",{className:"text-m flex items-center",children:e.jsx("span",{className:"mr-1",children:"Premier Subscribers"})}),e.jsx("div",{className:"h-16 mt-4 rounded-lg",children:e.jsx(x,{width:"100%",height:"100%",children:e.jsx(B,{data:q,children:e.jsx(R,{type:"monotone",dataKey:"count",stroke:"#F8F8FF",strokeWidth:2,activeDot:{r:8}})})})})]}),e.jsxs("div",{className:"bg-red-500 text-white rounded-lg shadow-lg p-4 min-h-[200px] sm:min-h-[250px] md:min-h-[300px]",children:[e.jsx("h2",{className:"text-3xl font-semibold",children:g(Z)}),e.jsxs("p",{className:"text-sm flex items-center",children:[e.jsx("span",{className:"text-lg mr-1",children:Fe(y)}),e.jsx("span",{className:`text-${y>0?"green":"red"}-300`,children:y>0?"â†‘":"â†“"})]}),e.jsx("p",{className:"text-m mt-2",children:"Revenue"}),e.jsx("div",{className:"h-40 w-full mt-4",children:e.jsx(x,{width:"100%",height:"50%",children:e.jsx(O,{data:J,children:e.jsx(v,{dataKey:"uv",fill:"#F8F8FF"})})})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-10",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-6",children:[e.jsxs("div",{className:"border flex flex-col justify-center items-center p-6 shadow rounded-lg bg-blue-100",children:[e.jsx(Ge,{className:"w-12 h-12 text-blue-700"}),e.jsx("h2",{className:"text-xl text-blue-700 font-semibold pt-4",children:"Total Users"}),e.jsx("p",{className:"text-2xl text-blue-700",children:de.length})]}),e.jsxs("div",{className:"border flex flex-col justify-center items-center p-6 shadow rounded-lg bg-green-100",children:[e.jsx(He,{className:"w-16 h-12 text-green-600"}),e.jsx("h2",{className:"text-xl font-semibold pt-4 text-green-600",children:"Total Orders"}),e.jsx("p",{className:"text-2xl text-green-600",children:j.length})]}),e.jsxs("div",{className:"border flex flex-col justify-center items-center p-6 shadow rounded-lg bg-yellow-100",children:[e.jsx(We,{className:"w-16 h-12 text-yellow-500"}),e.jsx("h2",{className:"text-xl font-semibold pt-4 text-yellow-500",children:"Total Payments"}),e.jsx("p",{className:"text-2xl text-yellow-500",children:F.length})]}),e.jsxs("div",{className:"border flex flex-col justify-center items-center p-6 shadow rounded-lg bg-purple-100",children:[e.jsx(Xe,{className:"w-16 h-12 text-purple-600"}),e.jsx("h2",{className:"text-xl font-semibold pt-4 text-purple-600",children:"Total Supplier"}),e.jsx("p",{className:"text-2xl text-purple-600",children:ye.length})]}),e.jsxs("div",{className:"border flex flex-col justify-center items-center p-6 shadow rounded-lg bg-red-100",children:[e.jsx(Ve,{className:"w-16 h-12 text-red-700"}),e.jsx("h2",{className:"text-xl font-semibold pt-4 text-red-700",children:"Total Products"}),e.jsx("p",{className:"text-2xl text-red-700",children:A.length})]}),e.jsxs("div",{className:"border flex flex-col justify-center items-center p-6 shadow rounded-lg bg-teal-100",children:[e.jsx(qe,{className:"w-16 h-12 text-teal-700"}),e.jsx("h2",{className:"text-xl font-semibold pt-4 text-teal-700",children:"Total Blogs"}),e.jsx("p",{className:"text-2xl text-teal-700",children:ue.length})]})]}),e.jsxs("div",{className:"p-6 shadow border rounded-lg mt-6",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Top Products"}),e.jsx(L,{sx:{height:400},children:e.jsx(K,{rows:A,columns:Ye,pageSize:100,pageSizeOptions:[5,10,20,50,100],rowHeight:73,checkboxSelection:!0,disableExtendRowFullWidth:!0,getRowId:t=>t.id,sx:{"& .MuiDataGrid-columnHeaders":{backgroundColor:u?"#333":"#f5f5f5"},"& .MuiDataGrid-row:hover":{backgroundColor:u?"rgb(36 48 63 / var(--tw-bg-opacity))":"#e0e0e0"}}})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-8 gap-10",children:[e.jsxs("div",{className:"lg:col-span-5 flex flex-col  mt-6 border rounded-md",children:[e.jsxs("div",{className:"my-4 px-6 flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Orders and Payments Analytics"}),e.jsxs("select",{value:b,onChange:t=>be(t.target.value),className:`px-4 py-2 border rounded-md ${u?"bg-custom-dark text-white":"bg-white text-black"}`,children:[e.jsx("option",{value:"day",children:"Day"}),e.jsx("option",{value:"month",children:"Month"}),e.jsx("option",{value:"year",children:"Year"})]})]}),e.jsx(x,{width:"100%",height:400,children:e.jsxs(Je,{data:Ie,margin:{left:50,right:20,top:20,bottom:20},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#8884d8",stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:"#8884d8",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"colorPv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0})]})]}),e.jsx(z,{strokeDasharray:"3 3"}),e.jsx(I,{dataKey:"date"}),e.jsx($,{tickFormatter:t=>g(t)}),e.jsx(p,{formatter:t=>g(t)}),e.jsx(D,{}),e.jsx(U,{type:"monotone",dataKey:"paymentAmount",stroke:"#8884d8",fillOpacity:1,fill:"url(#colorUv)",name:"Payments"}),e.jsx(U,{type:"monotone",dataKey:"orderAmount",stroke:"#82ca9d",fillOpacity:1,fill:"url(#colorPv)",name:"Orders"})]})})]}),e.jsx("div",{className:"lg:col-span-3 grid grid-cols-1 lg:grid-cols-1 gap-10",children:e.jsxs("div",{className:"p-6 shadow border rounded-lg mt-6",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Earning by Category"}),e.jsx(x,{width:"100%",height:400,children:e.jsxs(Y,{children:[e.jsx(T,{data:E,dataKey:"totalPrice",nameKey:"categoryName",cx:"50%",cy:"50%",outerRadius:150,innerRadius:80,fill:"#8884d8",label:$e,labelLine:!1,children:E.map((t,s)=>e.jsx(N,{fill:M[s%M.length]},`cell-${s}`))}),e.jsx(p,{formatter:t=>`${new Intl.NumberFormat("vi-VN").format(t)} Ä‘`}),e.jsx(D,{verticalAlign:"bottom",height:36})]})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-10",children:[e.jsxs("div",{className:"flex flex-col  mt-6 border rounded-md",children:[e.jsx("div",{className:"my-3 px-5 pt-4 flex justify-between items-center",children:e.jsx("h1",{className:"text-start font-bold text-2xl",children:"User Report"})}),e.jsx(x,{className:"p-2",width:"100%",height:450,children:e.jsxs(O,{data:he,children:[e.jsx(z,{strokeDasharray:"3 3"}),e.jsx(I,{dataKey:"date"}),e.jsx($,{}),e.jsx(p,{}),e.jsx(D,{}),e.jsx(v,{dataKey:"users",fill:"#8884d8",name:"Total Users",animationKey:"users"}),e.jsx(v,{dataKey:"usersPremium",fill:"#82ca9d",name:"Premium Users",animationKey:"usersPremium"})]})})]}),e.jsxs("div",{className:"p-6 shadow border rounded-lg mt-6",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"New Orders"}),e.jsx(L,{sx:{height:450},children:e.jsx(K,{rows:ze,columns:Oe,pageSize:100,pageSizeOptions:[5,10,20,50,100],rowHeight:68,checkboxSelection:!0,disableExtendRowFullWidth:!0,getRowId:t=>t.id,sx:{"& .MuiDataGrid-columnHeaders":{backgroundColor:u?"#333":"#f5f5f5"},"& .MuiDataGrid-row:hover":{backgroundColor:u?"rgb(36 48 63 / var(--tw-bg-opacity))":"#e0e0e0"}}})})]})]})]})]})]})}export{Nt as default};
