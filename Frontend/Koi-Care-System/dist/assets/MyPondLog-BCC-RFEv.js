import{d as A,r as n,u as M,j as e,m as z,a as c,B as d}from"./index-DJCnzeuI.js";/* empty css            */import{a as q}from"./index.esm-I7So98a0.js";import{F}from"./index-D1y2TWOl.js";import{S as O}from"./sweetalert2.esm.all-D3pEHXw3.js";import{L as B,H as W}from"./LeftSideBar-s30y6BoH.js";import{T as R}from"./TopLayout-DC-MKob9.js";import"./index-Bj-wzm2a.js";import"./index-CvwUA3zG.js";import"./index-CtFRRV_m.js";/* empty css            */import"./logo-DG-ZgLhE.js";import"./Typography-C8Tw1JDb.js";function oe(){const{isDarkMode:o}=A(),[p,w]=n.useState([]),[h,k]=n.useState(!1),[N,b]=n.useState(!1),[v,a]=n.useState(!1),[f,y]=n.useState([]),T=M(),{register:i,handleSubmit:j,formState:{errors:r},reset:g}=q(),x=()=>{k(!h),g({logTitle:"",logDate:"",category:p.category,note:"",koiPondId:""})},I=t=>{localStorage.setItem("logId",t.logId),g({logTitle:t.logTitle,logDate:t.logDate,category:t.category,note:t.note,koiPondId:t.koiPondName}),b(!0)},u=()=>{b(!1)},m=async()=>{try{const t=localStorage.getItem("token"),s=localStorage.getItem("id");t||console.log("not found token");const l=await c.get(`https://koicaresystemv2.azurewebsites.net/api/log/user/${s}/getAll`,{headers:{Authorization:`Bearer ${t}`}});w(l.data.data)}catch(t){console.log("err",t)}},E=async()=>{a(!0);const{isConfirmed:t}=await O.fire({title:"Are you sure?",text:"You wonâ€™t be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"});if(!t){a(!1);return}try{const s=localStorage.getItem("token");s||console.log("not found token");const l=localStorage.getItem("logId");await c.delete(`https://koicaresystemv2.azurewebsites.net/api/log/delete/${l}`,{headers:{Authorization:`Bearer ${s}`}}),d.success("Delete Pond Log Successfully"),m(),u()}catch(s){d.error("Delete Pond Log Fail"),console.log("err",s)}finally{a(!1)}},P=async()=>{var t,s;try{const l=localStorage.getItem("token"),S=localStorage.getItem("id");if(!l)throw new Error("No token found");const $=await c.get(`https://koicaresystemv2.azurewebsites.net/api/koiponds/user/${S}/koiponds`,{headers:{Authorization:`Bearer ${l}`}});y($.data.data)}catch(l){c.isAxiosError(l)?((t=l.response)==null?void 0:t.status)===401?(console.error("Unauthorized access - Token expired or invalid. Logging out..."),localStorage.removeItem("token"),localStorage.removeItem("id"),d.error("Token expired navigate to login"),T("/login")):console.error("Error fetching ponds:",(s=l.response)==null?void 0:s.status,l.message):console.error("An unexpected error occurred:",l)}},L=async t=>{a(!0);try{const s=localStorage.getItem("token");await c.post("https://koicaresystemv2.azurewebsites.net/api/log/create",{logTitle:t.logTitle,logDate:t.logDate,category:t.category,note:t.note,koiPondId:t.koiPondName},{headers:{Authorization:`Bearer ${s}`}}),console.log(t.koiPondName),d.success("Create Pond Log Successfully"),m(),x(!1),g()}catch{d.error("Create Pond Log Fail"),console.log(t.category)}finally{a(!1)}},C=async t=>{a(!0);try{const s=localStorage.getItem("token"),l=localStorage.getItem("logId");await c.put(`https://koicaresystemv2.azurewebsites.net/api/log/update/${l}`,{logTitle:t.logTitle,logDate:t.logDate,category:t.category,note:t.note,koiPondId:t.koiPondName},{headers:{Authorization:`Bearer ${s}`}}),d.success("Update Pond Log Successfully"),g(),m(),u()}catch(s){d.error("Update Pond Log Fail"),console.log(t.logDate),console.log(s),console.error(t.koiPondName)}finally{a(!1)}};n.useEffect(()=>{P()},[]),n.useEffect(()=>{m()},[]);const D=t=>{const s={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1};return new Date(t).toLocaleDateString(void 0,s)};return e.jsx("div",{children:e.jsxs("div",{className:"h-screen flex",children:[e.jsx(B,{}),e.jsxs("div",{className:`relative ${o?"bg-custom-dark text-white":"bg-white text-black"} shadow-xl flex-1 flex-col overflow-y-auto overflow-x-hidden`,children:[e.jsx(W,{}),e.jsxs("div",{className:"py-5 px-[30px] mx-auto max-w-[1750px]",children:[e.jsx(R,{text:"My Pond",textName:"My Pond Log",links:"member/myPond"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-10",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"fixed bottom-5 right-5 text-lg text-white outline-none rounded-full bg-custom-left-bar shadow-lg size-8 lg:size-14 cursor-pointer",onClick:()=>{x()},children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),p.map(t=>e.jsxs("div",{onClick:()=>I(t),className:"border border-gray-50 shadow-lg rounded-xl px-10 py-5",children:[e.jsxs("div",{className:"flex flex-col gap-1 lg:flex-row lg:justify-between",children:[e.jsx("div",{className:"text-2xl font-semibold",children:t.logTitle}),e.jsx("div",{className:"py-1 px-2 bg-blue-400 text-white rounded-lg",children:t.category})]}),e.jsx("div",{className:"flex justify-between",children:e.jsxs("div",{className:"flex-none w-[500px]",children:[e.jsx("div",{className:"lg:mt-5 mt-2 text-lg",children:t.koiPondName}),e.jsx("div",{className:"lg:mt-3 mt-1 text-red-500",children:D(t.logDate)}),e.jsx("div",{className:"lg:mt-3 mt-1",children:t.note})]})})]},t.logId)),h&&e.jsx("form",{onSubmit:j(L),className:"fixed inset-0 bg-black h-screen flex justify-center items-end bg-opacity-50 z-40",children:e.jsxs(z.div,{variants:{hidden:{opacity:0,y:-100},visible:{opacity:1,y:100,transition:{delay:2e3}}},className:` ${o?"bg-custom-dark":"bg-white"}  lg:min-w-[80vh] m-auto p-6 lg:rounded-lg`,children:[e.jsxs("div",{className:"flex justify-between mb-5",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",onClick:()=>{x()},className:"size-10 text-red-500 cursor-pointer",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),e.jsx("button",{type:"submit",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-10 text-green-500 cursor-pointer",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})})})]}),e.jsx("h3",{className:"mb-5 lg:text-2xl text-lg font-bold",children:"Add a Log"}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-rows-2 gap-4",children:[e.jsxs("div",{className:"relative lg:mb-4 col-span-1",children:[e.jsx("label",{htmlFor:"name",className:`absolute block -top-[12px] ${o?"bg-custom-dark":"bg-white"} left-3 lg:text-lg text-sm text-red-500 font-semibold`,children:"Title:"}),e.jsx("input",{type:"text",id:"name",placeholder:"Enter title",className:`w-full lg:p-3 px-2 py-1 ${o?"bg-custom-dark":"bg-white"} border border-black lg:text-lg text-sm rounded-lg focus:outline-none transition-colors duration-200`,...i("logTitle",{required:"Title is required"})}),r.logTitle&&e.jsx("p",{className:"text-red-500 absolute lg:text-lg text-sm",children:r.logTitle.message})]}),e.jsxs("div",{className:"relative lg:mb-4 col-span-1",children:[e.jsx("label",{className:`absolute -top-[12px] left-3 text-red-500 ${o?"bg-custom-dark":"bg-white"} font-semibold lg:text-lg text-sm`,children:"Date & time:"}),e.jsx("input",{type:"datetime-local",min:new Date().toISOString().slice(0,16),placeholder:"Enter date & time",className:`w-full lg:p-3 px-2 py-1 ${o?"bg-custom-dark":"bg-white"} border border-black rounded-lg lg:text-lg text-sm focus:outline-none transition-colors duration-200`,...i("logDate",{required:"Date Time is required"})}),r.logDate&&e.jsx("p",{className:"text-red-500 absolute lg:text-lg text-sm",children:r.logDate.message})]}),e.jsxs("div",{className:"lg:mb-4 relative col-span-1",children:[e.jsx("label",{className:`absolute -top-[12px] left-3 text-red-500 ${o?"bg-custom-dark":"bg-white"} font-semibold lg:text-lg text-sm`,children:"Category:"}),e.jsxs("select",{id:"pondId",className:`w-full lg:p-3 px-2 py-1 ${o?"bg-custom-dark":"bg-white"} border border-black rounded-lg lg:text-lg text-sm focus:outline-none transition-colors duration-200`,...i("category",{required:"Category is required"}),children:[e.jsx("option",{value:"WATER_CHANGE",children:"Water Change"}),e.jsx("option",{value:"KOI_TREATMENT",children:"Koi Treatment"}),e.jsx("option",{value:"WATER_TREATMENT",children:"Water Treatment"}),e.jsx("option",{value:"POPULATION_CHANGE",children:"Population Change"}),e.jsx("option",{value:"EXPERIENCE",children:"Experience"}),e.jsx("option",{value:"POND_MODIFICATION",children:"Pond Modification"}),e.jsx("option",{value:"OTHER",children:"Other"})]})]}),e.jsxs("div",{className:"mb-4 relative col-span-1",children:[e.jsx("label",{className:`absolute -top-[12px] left-3 text-red-500 ${o?"bg-custom-dark":"bg-white"} font-semibold lg:text-lg text-sm`,children:"Pond:"}),e.jsx("select",{id:"pondId",className:`w-full lg:p-3 px-2 py-1 ${o?"bg-custom-dark":"bg-white"} border border-black rounded-lg lg:text-lg text-sm focus:outline-none transition-colors duration-200`,...i("koiPondName",{required:"Pond is required"}),children:f.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))})]})]}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("label",{className:`absolute -top-[12px] left-3 text-red-500 ${o?"bg-custom-dark":"bg-white"} font-semibold lg:text-lg text-sm`,children:"Note:"}),e.jsx("textarea",{type:"text",placeholder:"Note",className:`w-full lg:h-32 h-24 p-3 ${o?"bg-custom-dark":"bg-white"} border border-black rounded-lg focus:outline-none transition-colors duration-200`,...i("note",{required:"Note is required"})}),r.note&&e.jsx("p",{className:"text-red-500 absolute lg:text-lg text-sm",children:r.note.message})]})]})}),N&&e.jsx("form",{onSubmit:j(C),className:"fixed inset-0 bg-black h-screen flex justify-center items-end bg-opacity-50 z-40",children:e.jsxs("div",{className:`${o?"bg-custom-dark":"bg-white"}  lg:min-w-[80vh] my-auto p-6 rounded-lg shadow-lg`,children:[e.jsxs("div",{className:"flex justify-between mb-5",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",onClick:()=>{u()},className:"size-10 text-red-500 cursor-pointer",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),e.jsx("button",{type:"submit",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-10 text-green-500 cursor-pointer",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})})})]}),e.jsx("h3",{className:"mb-5 lg:text-2xl text-xl font-bold",children:"Update a Log"}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-rows-2 gap-4",children:[e.jsxs("div",{className:"lg:mb-4 relative col-span-1",children:[e.jsx("label",{htmlFor:"name",className:`absolute block -top-[12px] ${o?"bg-custom-dark":"bg-white"} left-3 text-red-500 font-semibold lg:text-lg text-sm`,children:"Title:"}),e.jsx("input",{type:"text",placeholder:"Enter title",className:`w-full lg:p-3 px-2 py-1 ${o?"bg-custom-dark":"bg-white"} border border-black rounded-lg focus:outline-none transition-colors duration-200`,...i("logTitle",{required:"Title is required"})}),r.logTitle&&e.jsx("p",{className:"text-red-500 absolute lg:text-lg text-sm",children:r.logTitle.message})]}),e.jsxs("div",{className:"lg:mb-4 relative col-span-1",children:[e.jsx("label",{className:`absolute -top-[12px] left-3 text-red-500 ${o?"bg-custom-dark":"bg-white"} font-semibold lg:text-lg text-sm`,children:"Date & time:"}),e.jsx("input",{type:"datetime-local",min:new Date().toISOString().slice(0,16),placeholder:"Enter Date Time",className:`w-full lg:p-3 px-2 py-1 ${o?"bg-custom-dark":"bg-white"} border border-black rounded-lg focus:outline-none transition-colors duration-200`,...i("logDate",{required:"Date Time is required"})}),r.logDate&&e.jsx("p",{className:"text-red-500 absolute lg:text-lg text-sm",children:r.logDate.message})]}),e.jsxs("div",{className:"relative col-span-1",children:[e.jsx("label",{className:`absolute -top-[12px] left-3 text-red-500 ${o?"bg-custom-dark":"bg-white"} font-semibold lg:text-lg text-sm`,children:"Category:"}),e.jsxs("select",{id:"pondId",className:`w-full lg:p-3 px-2 py-1 ${o?"bg-custom-dark":"bg-white"} border border-black rounded-lg focus:outline-none transition-colors duration-200`,...i("category",{required:"Category is required"}),children:[e.jsx("option",{value:"WATER_CHANGE",children:"Water Change"}),e.jsx("option",{value:"KOI_TREATMENT",children:"Koi Treatment"}),e.jsx("option",{value:"WATER_TREATMENT",children:"Water Treatment"}),e.jsx("option",{value:"POPULATION_CHANGE",children:"Population Change"}),e.jsx("option",{value:"EXPERIENCE",children:"Experience"}),e.jsx("option",{value:"POND_MODIFICATION",children:"Pond Modification"}),e.jsx("option",{value:"OTHER",children:"Other"})]})]}),e.jsxs("div",{className:"mb-4 relative col-span-1",children:[e.jsx("label",{htmlFor:"drainCount",className:`absolute -top-[12px] left-3 text-red-500 ${o?"bg-custom-dark":"bg-white"} font-semibold lg:text-lg text-sm`,children:"Pond:"}),e.jsx("select",{id:"pondId",className:`w-full lg:p-3 px-2 py-1 ${o?"bg-custom-dark":"bg-white"} border border-black rounded-lg focus:outline-none transition-colors duration-200`,...i("koiPondName",{required:"Pond is required"}),children:f.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))})]})]}),e.jsxs("div",{className:"lg:mt-4 relative w-full",children:[e.jsx("label",{className:`absolute -top-[12px] left-3 text-red-500 ${o?"bg-custom-dark":"bg-white"} font-semibold lg:text-lg text-sm`,children:"Note:"}),e.jsx("textarea",{type:"text",placeholder:"Note",className:`w-full lg:h-32 h-24 p-3 ${o?"bg-custom-dark":"bg-white"} border border-black rounded-lg focus:outline-none transition-colors duration-200`,...i("note",{required:"Note is required"})}),r.note&&e.jsx("p",{className:"text-red-500 absolute lg:text-lg text-sm",children:r.note.message})]}),e.jsxs("div",{className:"w-full flex flex-col justify-center",children:[e.jsx("button",{className:"mx-auto",onClick:()=>{E()},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"lg:size-12 size-8 mx-auto lg:p-2 p-1 rounded-full bg-red-500 text-white cursor-pointer mt-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5m6 4.125 2.25 2.25m0 0 2.25 2.25M12 13.875l2.25-2.25M12 13.875l-2.25 2.25M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"})})}),e.jsx("p",{className:"text-center font-semibold",children:"Delete this log"})]})]})}),v&&e.jsx("div",{className:"fixed inset-0 px-4 py-2 flex items-center justify-center z-50",children:e.jsx(F,{className:"animate-spin text-green-500 text-6xl"})})]})]})]})]})})}export{oe as default};
