import{d as D,r as i,j as e,a as y}from"./index-Qtd3etr3.js";import{L as H,H as O}from"./LeftSideBar-FT7tCOUc.js";import{T as R}from"./TopLayout-DUOKeQ7A.js";import"./index-BuglD1Vv.js";import"./index-DF6yzlP_.js";import"./index-CYe7FaXN.js";import"./index-CdZqjTQo.js";/* empty css            */import"./logo-DG-ZgLhE.js";import"./Typography-Ccp8Yzjl.js";function _(){const{isDarkMode:P}=D(),[n,$]=i.useState([]),[a,x]=i.useState(null),[m,v]=i.useState([]),[N,k]=i.useState(0),[c,z]=i.useState(.1),[h,w]=i.useState(0),[l,g]=i.useState("low"),[o,E]=i.useState("6-8"),M=["6-8","9-12","13-16","17-20","21-28"],[d,A]=i.useState("percent"),B=async()=>{try{const t=localStorage.getItem("token"),s=localStorage.getItem("id");if(!t)throw new Error("No token found");const u=(await y.get(`https://koicaresystemv2.azurewebsites.net/api/koiponds/user/${s}/koiponds`,{headers:{Authorization:`Bearer ${t}`}})).data.data,b=await Promise.all(u.map(async j=>{var T;try{const p=await y.get(`https://koicaresystemv2.azurewebsites.net/api/water-parameters/getLatestByKoiPondId/${j.id}`,{headers:{Authorization:`Bearer ${t}`}});return{...j,temperature:(T=p.data.data)==null?void 0:T.temperature}}catch(p){if(p.response&&p.response.status===404)return console.warn(`Water parameters not found for pond with ID ${j.id}`),{...j,temperature:null};throw p}}));$(b),console.log(b)}catch(t){console.error("Error fetching ponds or water parameters:",t.response?t.response.data:t.message)}};i.useEffect(()=>{B()},[]),i.useEffect(()=>{n.length===1&&x(n[0])},[n]);const S=async t=>{try{const s=localStorage.getItem("token");if(!s)throw new Error("No token found");const r=await y.get(`https://koicaresystemv2.azurewebsites.net/api/koifishs/koipond/${t}/allKoi`,{headers:{Authorization:`Bearer ${s}`}});v(r.data.data)}catch(s){console.error("Error fetching fish:",s)}},I=t=>{const s=t.target.value,r=n.find(u=>u.id===parseInt(s));r?(x(r),S(s)):(x(null),v([]))},F=i.useCallback(t=>{let s=1,r=1;l==="low"&&(o==="6-8"&&(s=.002,r=.003),o==="9-12"&&(s=.003,r=.007),o==="13-16"&&(s=.007,r=.015),o==="17-20"&&(s=.015,r=.025),o==="21-28"&&(s=.025,r=.04)),l==="mid"&&(o==="13-16"&&(s=.01,r=.02),o==="17-20"&&(s=.02,r=.03),o==="21-28"&&(s=.03,r=.05)),l==="high"&&(o==="13-16"&&(s=.01,r=.015),o==="17-20"&&(s=.015,r=.025),o==="21-28"&&(s=.025,r=.04));const u=t*s,b=t*r;return{min:u,max:b}},[l,o]),C=i.useCallback(t=>t*(c/100),[c]),W=()=>d==="percent"?"You are in Percent Mode, We still recommend using the preset food calculator! Use the Percent Mode only if you already have a lot of experience with koi and know what you are doing!":o==="6-8"?`The koi should only receive the prescribed amount of food every two to three days.
In any case, feeding should be stopped when the temperature drops below 6°C!
Because of the koi's decreased metabolism, the growth targets "medium" and "high" are not selectable in the 6–8°C temperature range.`:o==="9-12"?`The recommended amount of food should be split evenly into 2-3 feedings per day.
Because of the koi's decreased metabolism, the growth targets "medium" and "high" are not selectable in the 9–12°C temperature range.`:o==="13-16"?"It is advisable to divide the recommended daily intake of meals into 4-6 feedings. The food will be better absorbed by the koi in this method.":o==="17-20"?"The recommended amount of food should be split evenly into 3-5 feedings per day. The food will be better absorbed by the koi in this method.":`The recommended amount of food should be split evenly into 4-8 feedings per day. The food will be better absorbed by the koi in this method.
Over 28°C is not a good temperature to feed at!`;i.useEffect(()=>{if(m.length>0){const t=m.reduce((s,r)=>s+r.weight,0);if(k(t),d==="percent")w(C(t));else{const s=F(t);w(s)}}else k(0),w(0)},[m,c,l,o,d,C,F]);const f=t=>["6-8","9-12"].includes(o)?t!=="low":!1;i.useEffect(()=>{["6-8","9-12"].includes(o)&&l!=="low"&&g("low")},[o,l]),i.useEffect(()=>{if(n.length===1){const t=n[0];x(t),S(t.id)}},[n]);const L=()=>{if(!a||!a.temperature)return"No temperature data available";let t=0;if(a.temperature>=13&&a.temperature<=16)t=.015;else if(a.temperature>=17&&a.temperature<=20)t=.02;else if(a.temperature>=21&&a.temperature<=28)t=.025;else return"Temperature out of range for recommendations";return`${(N*t).toFixed(2)}g per day`};return e.jsx("div",{children:e.jsxs("div",{className:"h-screen flex",children:[e.jsx(H,{}),e.jsxs("div",{className:`relative ${P?"bg-custom-dark text-white":"bg-white text-black"} shadow-xl flex-1 flex-col overflow-y-auto overflow-x-hidden`,children:[e.jsx(O,{}),e.jsxs("div",{className:"py-5 px-[30px] mx-auto max-w-[1750px]",children:[e.jsx(R,{text:"Food Calculator"}),e.jsxs("div",{className:"p-2 text-lg min-h-screen",children:[e.jsxs("div",{className:"lg:text-lg text-sm flex lg:items-center lg:flex-row flex-col lg:gap-5 gap-3",children:[e.jsx("label",{htmlFor:"ponds",children:"Select a Pond:"}),e.jsxs("select",{id:"ponds",className:"border rounded p-2 text-black",value:a?a.id:"all",onChange:I,children:[e.jsx("option",{value:"all",disabled:!0,children:"All Ponds"}),n.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsx("div",{className:"mt-4",children:m.length>0?e.jsx("div",{children:e.jsxs("p",{className:"lg:text-lg text-sm",children:["Total Fish Weight: ",e.jsxs("strong",{children:[N.toFixed(2),"g"]})]})}):e.jsxs("p",{className:"lg:text-lg text-sm",children:["Total Fish Weight: ",e.jsx("strong",{children:"0g"})]})}),a&&e.jsxs("div",{className:"mt-4",children:[e.jsx("strong",{children:"Temperature:"})," ",a.temperature>=0?`${a.temperature}°C`:"No water parameters in pond",a.temperature&&e.jsxs("p",{children:["Follow on the current water parameters infomation We recommended the amount of food for their koi in pond : ",e.jsx("strong",{children:L()})]})]}),a&&e.jsxs("div",{children:[e.jsxs("div",{className:"mt-4 lg:p-4 grid lg:grid-cols-3 grid-cols-1 space-x-2",children:[e.jsxs("div",{className:"col-span-1",children:[e.jsx("div",{className:"mt-4",children:e.jsxs("button",{onClick:()=>A(d==="percent"?"size":"percent"),className:"bg-blue-500 text-white px-4 py-2 rounded lg:text-lg text-sm",children:["Switch to ",d==="percent"?"Size and Temperature Mode":"Percent Mode"]})}),d==="percent"?e.jsx("div",{className:"p-4  w-4/5 ",children:e.jsxs("label",{className:"lg:text-lg text-sm",children:["Current percent (%):",e.jsx("input",{type:"range",min:"0.1",max:"2.5",step:"0.1",value:c,onChange:t=>z(t.target.value),className:"slider-thumb",style:{"--value":`${c/2.5*100}%`}}),e.jsxs("span",{className:"ml-2",children:[c,"%"]})]})}):e.jsxs("div",{className:"mt-4 lg:text-lg text-sm",children:[e.jsx("label",{children:"Select Fish Size:"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>g("low"),className:`px-4 py-2 rounded ${l==="low"?"bg-blue-500 text-white":"bg-gray-200 text-blue-500"}`,children:"Low"}),e.jsx("button",{onClick:()=>g("mid"),disabled:f("mid"),className:`px-4 py-2 rounded ${l==="mid"?"bg-blue-500 text-white":"bg-gray-200 text-blue-500"} ${f("mid")?"opacity-50 cursor-not-allowed":""}`,children:"Mid"}),e.jsx("button",{onClick:()=>g("high"),disabled:f("high"),className:`px-4 py-2 rounded ${l==="high"?"bg-blue-500 text-white":"bg-gray-200 text-blue-500"} ${f("high")?"opacity-50 cursor-not-allowed":""}`,children:"High"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{children:"Select Temperature (°C):"}),e.jsx("div",{className:"grid lg:grid-cols-5 md:grid-cols-4 grid-cols-3 gap-2",children:M.map(t=>e.jsx("button",{onClick:()=>E(t),className:`px-4 py-2 rounded lg:text-lg text-sm  ${o===t?"bg-blue-500 text-white":"bg-gray-200 text-blue-500  "}`,children:t},t))})]})]})]}),e.jsxs("div",{className:"lg:text-lg text-base text-justify notes p-4 border justify-center text-black bg-white lg:py-20 mt-5 rounded shadow col-span-2 ",children:[e.jsx("h3",{children:"Notes:"}),e.jsx("p",{children:W()})]})]}),e.jsx("div",{className:"w-min-full bottom-5 lg:text-xl mt-5 text-sm block footer lg:w-2/4 bg-slate-600 text-white border-solid rounded-lg mx-auto py-5 text-center",children:m.length>0?d==="percent"?e.jsxs("p",{children:["Food Amount: ",e.jsxs("strong",{children:[isNaN(h)?0:h.toFixed(2),"g"]}),e.jsx("strong",{children:"/Perday"})]}):e.jsxs("p",{children:["Food Amount:"," ",e.jsxs("strong",{children:[isNaN(h.min)?0:h.min.toFixed(2),"g -"," ",isNaN(h.max)?0:h.max.toFixed(2),"g",e.jsx("strong",{children:"/Perday"})]})]}):e.jsxs("p",{children:["Total Fish Weight: ",e.jsx("strong",{children:"0g"})]})})]}),!a&&e.jsx("div",{className:"mt-4  text-lg",children:e.jsx("p",{children:e.jsx("strong",{children:"Please select a pond."})})})]})]})]})]})})}export{_ as default};
