import{e as q,d as E,u as F,r as d,j as e,a as c,B as p}from"./index-D0YIHR4A.js";import{L as T,H as z}from"./LeftSideBar-BipZwdxj.js";import{T as B}from"./TopLayoutShop-B_mN4XiN.js";import{a as D}from"./index.esm-BJdVWKmv.js";import"./index-DfkVdce-.js";import"./index-BMdVHJVA.js";import"./index-aIHYwc5K.js";/* empty css            */import"./logo-DG-ZgLhE.js";function J(){const{id:l}=q(),{isDarkMode:i}=E(),y=F(),[n,x]=d.useState(!1),[_,m]=d.useState(!0),[a,b]=d.useState([]),[h,f]=d.useState([]),[N,w]=d.useState([]),{register:o,handleSubmit:j,formState:{errors:r},reset:k}=D(),v=async()=>{try{const t=localStorage.getItem("token");if(!t)throw new Error("No token found");const s=await c.get("https://koicaresystemv2.azurewebsites.net/api/categories/all",{headers:{Authorization:`Bearer ${t}`}});f(s.data.data)}catch(t){console.log("Error fetching category:",t)}};d.useEffect(()=>{v()},[]);const $=async()=>{try{const t=localStorage.getItem("token");if(!t)throw new Error("No token found");const s=await c.get("https://koicaresystemv2.azurewebsites.net/api/suppliers/all",{headers:{Authorization:`Bearer ${t}`}});w(s.data.data)}catch(t){console.log("Error fetching tags:",t)}};d.useEffect(()=>{$()},[]);const S=async()=>{try{const t=localStorage.getItem("token");if(!t)throw new Error("No token found");const s=await c.get(`https://koicaresystemv2.azurewebsites.net/api/products/product/${l}/product`,{headers:{Authorization:`Bearer ${t}`}});b(s.data.data),k(s.data.data)}catch(t){console.error("Error fetching Product:",t),p.error("Failed to fetch Product details.")}finally{m(!1)}};d.useEffect(()=>{S()},[l]);const I=async t=>{m(!0),x(!0);try{const s=localStorage.getItem("token");if(!s)throw new Error("No token found");const g=await c.put(`https://koicaresystemv2.azurewebsites.net/api/products/product/${l}/update`,{name:t.name,brand:t.brand,price:t.price,inventory:t.inventory,description:t.description,description_detail:t.description_detail,category:{id:a.category.id,name:a.category.name},supplierName:t.supplierName,issueTypeId:t.issueTypeId.split(",").map(u=>parseInt(u.trim())).filter(u=>!isNaN(u))},{headers:{Authorization:`Bearer ${s}`}});p.success("Product updated successfully!"),y("/admin/product")}catch(s){console.log(t.id),console.log(s),p.error("Failed to update Product.")}finally{x(!1),m(!1)}},P=t=>{I(t)};return e.jsxs("div",{className:"h-screen flex",children:[e.jsx(T,{}),e.jsxs("div",{className:`relative ${i?"bg-custom-light text-white":"bg-white text-black"} overflow-y-auto flex-1 flex-col  overflow-x-hidden duration-200 ease-linear`,children:[e.jsx(z,{}),e.jsxs("div",{className:"py-5 pb-0 px-[30px] max-w-[1750px] mx-auto",children:[e.jsx(B,{text:"Product",textName:"Update Product",links:"admin/product"}),e.jsx("div",{className:"p-6 rounded-md border",children:e.jsxs("form",{onSubmit:j(P),noValidate:!0,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium mb-2",children:"Product Name"}),e.jsx("input",{type:"text",id:"name",className:`w-full p-2 border rounded-md ${i?"bg-custom-dark text-white":"bg-white text-black"} ${r.name?"border-red-500":"border-gray-300"}`,...o("name",{required:"Name is required",minLength:2,maxLength:50})}),r.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.name.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"brand",className:"block text-sm font-medium mb-2",children:"Brand"}),e.jsx("input",{type:"text",id:"brand",className:`w-full p-2 border rounded-md ${i?"bg-custom-dark text-white":"bg-white text-black"} ${r.brand?"border-red-500":"border-gray-300"}`,...o("brand",{required:"Brand is required"})}),r.brand&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.brand.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"price",className:"block text-sm font-medium mb-2",children:"Price"}),e.jsx("input",{type:"number",id:"price",className:`w-full p-2 border rounded-md ${i?"bg-custom-dark text-white":"bg-white text-black"} ${r.price?"border-red-500":"border-gray-300"}`,...o("price",{required:"Price is required"})}),r.price&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.price.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"inventory",className:"block text-sm font-medium mb-2",children:"Inventory"}),e.jsx("input",{type:"number",id:"inventory",className:`w-full p-2 border rounded-md ${i?"bg-custom-dark text-white":"bg-white text-black"} ${r.inventory?"border-red-500":"border-gray-300"}`,...o("inventory",{required:"Inventory is required"})}),r.inventory&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.inventory.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium mb-2",children:"Description"}),e.jsx("textarea",{id:"description",className:`w-full p-2 border rounded-md ${i?"bg-custom-dark text-white":"bg-white text-black"} ${r.description?"border-red-500":"border-gray-300"}`,...o("description",{required:"Description is required"})}),r.description&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.description.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"description_detail",className:"block text-sm font-medium mb-2",children:"Detailed Description"}),e.jsx("textarea",{id:"description_detail",className:`w-full p-2 border rounded-md ${i?"bg-custom-dark text-white":"bg-white text-black"} ${r.description_detail?"border-red-500":"border-gray-300"}`,...o("description_detail",{required:"Detailed description is required"})}),r.description_detail&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.description_detail.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"category",className:"block text-sm font-medium mb-2",children:"Category"}),e.jsxs("select",{id:"category",className:`w-full p-2 border rounded-md ${i?"bg-custom-dark text-white":"bg-white text-black"} ${r.category?"border-red-500":"border-gray-300"}`,defaultValue:a.category?a.category.id:"null",onChange:t=>{const s=h.find(g=>g.id==t.target.value);b({...a,category:s})},children:[a.category&&e.jsx("option",{value:a.category.id,children:a.category.name}),h.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),r.category&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.category.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"supplierName",className:"block text-sm font-medium mb-2",children:"Supplier"}),e.jsxs("select",{id:"supplierName",className:`w-full p-2 border rounded-md ${i?"bg-custom-dark text-white":"bg-white text-black"} ${r.supplierName?"border-red-500":"border-gray-300"}`,...o("supplierName"),children:[e.jsx("option",{value:a.supplier?a.supplier.name:"",children:a.supplier?a.supplier.name:""}),N.map(t=>e.jsx("option",{value:t.name,children:t.name},t.id))]}),r.supplierName&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:r.supplierName.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"issueTypeId",className:"block text-sm font-medium mb-2",children:"Issue Type"}),e.jsx("input",{type:"text",id:"issueTypeId",className:`w-full p-2 border rounded-md ${i?"bg-custom-dark text-white":"bg-white text-black"} ${r.issueTypeId?"border-red-500":"border-gray-300"}`,...o("issueTypeId",{required:!1})})]}),e.jsx("button",{type:"submit",className:`mt-5 w-full bg-blue-600 text-white p-2 rounded-md ${n?"opacity-50 cursor-not-allowed":""}`,disabled:n,children:n?"Update...":"Update Product"})]})})]})]})]})}export{J as default};
