import{d as k,r as d,u as v,j as t,B as b,a as p}from"./index-B6lDE10X.js";import{L as S,H as y}from"./LeftSideBar-DCaJzvyX.js";import{T as E}from"./TopLayoutShop-u0HFtlA5.js";import{a as $}from"./index.esm-DwyVgujN.js";import{S as P}from"./react-select.esm-B5EU9M55.js";import{i as R}from"./react-select-animated.esm-CLxPBIrP.js";import"./index-CwQ8PTPA.js";import"./index-C82jgAjb.js";import"./index-pU6niAKh.js";/* empty css            */import"./logo-DG-ZgLhE.js";import"./Transition-CB3Oswcw.js";import"./toPropertyKey-CGv2wOyp.js";function Q(){const{isDarkMode:r}=k(),[l,c]=d.useState(!1),[x,h]=d.useState([]),[m,F]=d.useState([]),g=v(),{register:i,handleSubmit:f,formState:{errors:s},reset:C,watch:n}=$(),D=async e=>{console.log("onSubmit:",e),c(!0);const a=new Date(e.startDate),u=new Date(e.endDate);if(a>u){b.error("Start date cannot be after end date."),c(!1);return}try{const o=localStorage.getItem("token");if(!o)throw new Error("No token found");const j={name:e.name,startDate:e.startDate,endDate:e.endDate,discountRate:e.discountRate,description:e.description,productIds:m},q=await p.post("https://koicaresystemv2.azurewebsites.net/api/promotions/create",j,{headers:{Authorization:`Bearer ${o}`}});b.success("Promotion created successfully!"),g("/shop/promotion")}catch(o){console.log(o),b.error("Failed to create Promotion.")}finally{c(!1)}},w=async()=>{try{const e=localStorage.getItem("token");if(!e)throw new Error("No token found");const u=(await p.get("https://koicaresystemv2.azurewebsites.net/api/products/all",{headers:{Authorization:`Bearer ${e}`}})).data.data.filter(o=>o.id>3);h(u)}catch(e){console.log("Error fetching products:",e)}};d.useEffect(()=>{w()},[]);const N=e=>{F(e.map(a=>a.value))};return t.jsxs("div",{className:"h-screen flex",children:[t.jsx(S,{}),t.jsxs("div",{className:`relative ${r?"bg-custom-light text-white":"bg-white text-black"} overflow-y-auto flex-1 flex-col overflow-x-hidden duration-200 ease-linear`,children:[t.jsx(y,{}),t.jsxs("div",{className:"py-5 pb-0 px-[30px] mx-auto",children:[t.jsx(E,{text:"Promotion",textName:"Create Promotion",links:"shop/promotion"}),t.jsx("div",{className:` p-6 rounded-md border ${r?"bg-gray-800 text-white":"bg-white text-black"}`,children:t.jsxs("form",{onSubmit:f(D),noValidate:!0,children:[t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"name",className:"block text-sm font-medium mb-2",children:"Promotion Name"}),t.jsx("input",{type:"text",id:"name",className:`w-full p-2 border rounded-md ${r?"bg-custom-dark text-white":"bg-white text-black"} ${s.name?"border-red-500":"border-gray-300"}`,...i("name",{required:"Name is required",minLength:{value:2,message:"Name must be at least 2 characters long"},maxLength:{value:50,message:"Name must not exceed 50 characters"}})}),s.name&&t.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.name.message})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"productId",className:"block text-sm font-medium mb-2",children:"Select Products"}),t.jsx(P,{isMulti:!0,options:x.map(e=>({value:e.id,label:e.name})),value:x.filter(e=>m.includes(e.id)).map(e=>({value:e.id,label:e.name})),onChange:N,className:` ${s.products?"border-red-500":"border-gray-300"}`,closeMenuOnSelect:!1,components:R(),styles:{control:(e,a)=>({...e,backgroundColor:r?"#1F2937":"#FFFFFF",color:r?"#FFFFFF":"#000000",borderColor:s.products?"#EF4444":"#D1D5DB","&:hover":{borderColor:s.products?"#EF4444":"#9CA3AF"}}),menu:e=>({...e,backgroundColor:r?"#1F2937":"#FFFFFF"}),option:(e,a)=>({...e,backgroundColor:a.isFocused?r?"#374151":"#E5E7EB":r?"#1F2937":"#FFFFFF",color:r?"#FFFFFF":"#000000"}),multiValue:e=>({...e,backgroundColor:r?"#4B5563":"#E5E7EB",color:r?"#FFFFFF":"#000000"}),multiValueLabel:e=>({...e,color:r?"#FFFFFF":"#000000"}),multiValueRemove:e=>({...e,color:r?"#FFFFFF":"#000000",":hover":{backgroundColor:r?"#374151":"#D1D5DB",color:r?"#F87171":"#EF4444"}})}}),m.length===0&&t.jsx("p",{className:"text-red-500 text-xs mt-1",children:"At least one product is required"})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"startDate",className:"block text-sm font-medium mb-2",children:"Start Date"}),t.jsx("input",{type:"datetime-local",id:"startDate",className:`w-full p-2 border rounded-md ${r?"bg-custom-dark text-white":"bg-white text-black"} ${s.startDate?"border-red-500":"border-gray-300"}`,...i("startDate",{required:"Start Date is required"}),min:new Date().toISOString().split("T")[0],max:n("endDate")?new Date(n("endDate")).toISOString().split("T")[0]:void 0}),s.startDate&&t.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.startDate.message})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"endDate",className:"block text-sm font-medium mb-2",children:"End Date"}),t.jsx("input",{type:"datetime-local",id:"endDate",className:`w-full p-2 border rounded-md ${r?"bg-custom-dark text-white":"bg-white text-black"} ${s.endDate?"border-red-500":"border-gray-300"}`,...i("endDate",{required:"End Date is required"}),min:n("startDate")?new Date(n("startDate")).toISOString().split("T")[0]:void 0}),s.endDate&&t.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.endDate.message})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{htmlFor:"discountRate",className:"block text-sm font-medium mb-2",children:"Discount Rate"}),t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"number",id:"discountRate",className:`w-full p-2 border rounded-md ${r?"bg-custom-dark text-white":"bg-white text-black"} ${s.discountRate?"border-red-500":"border-gray-300"}`,...i("discountRate",{required:"Discount Rate is required",min:{value:0,message:"Discount Rate cannot be less than 0%"},max:{value:100,message:"Discount Rate cannot exceed 100%"}})}),t.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"%"})]}),s.discountRate&&t.jsx("p",{className:"text-red-500 text-xs mt-1",children:s.discountRate.message})]}),t.jsxs("div",{className:"mb-4 ",children:[t.jsx("label",{htmlFor:"description",className:"block text-sm font-medium mb-2",children:"Description"}),t.jsx("textarea",{rows:"6",id:"description",className:`w-full p-2 border rounded-md ${r?"bg-custom-dark text-white":"bg-white text-black"} ${s.description?"border-red-500":"border-gray-300"}`,...i("description")})]}),t.jsx("button",{type:"submit",className:`px-4 py-2 bg-blue-600 text-white rounded-md ${l?"opacity-50 cursor-not-allowed":"hover:bg-blue-700"}`,disabled:l,children:l?"Submitting...":"Create Promotion"})]})})]})]})]})}export{Q as default};
